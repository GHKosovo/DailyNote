## 剖析微信公众号的流程

### 初始化界面：自定义菜单（关注 / 未关注）

自定义菜单，分别有**我的报告**，**我的社区**和**个人中心**三个功能模块

关注/未关注都可点开链接，主要跳转链接为登录注册，链接的scope为snsapi_userinfo，获取用户信息，；其他链接也是都需要登录后才能够后访问数据，在其他链接的页面，当点击到页面的某些需要访问数据的地方时直接跳转到登录页面。

> 获取用户信息跟登录的账号信息不是一块存储的，获取的用户信息只用于个人中心中头像/昵称的显示，二账号信息则跟绑定条形码等信息相关。

这里获取的用户信息只用于下一步注册登录后显示个人信息，不存储到数据库中

### 个人中心

#### 注册页面

注册的账户信息，用于存储用户条形码等信息；注册完成后，弹出登录界面模块；

#### 登录页面

注册用户后方可使用其注册账户登录，登录后直接跳转到主页（可关联条形码）；

主页功能：绑定条形码和查看我的报告两个子功能；每个账户可绑定多个条形码，每个条形码对应一个个人

##### 绑定条形码：弹出新的页面，用于用户填写个人信息和条形码

**这里涉及到四张数据库表的关联，分别是账户表，条形码表，采集盒状态表和采集盒表**

**账户表**主要收集账户名和密码和openid （通过用户名来关联条形码）

**条形码表**收集条形码和对应的openid和个人详细信息（地址，出生年月日，采集盒状态和手机等）

**采集盒状态表** 用于表示采集盒是否接收完成

**采集盒表**用于收集条形码和其对应的报告路径（此采集盒表的条形码跟条形码表不用相关联）

绑定条形码会有条款告知！然后再绑定成功后显示绑定成功页面，等待五秒返回到主页面。

##### 查看我的报告：弹出我的报告页面

### 我的报告

进入我的报告页面，以表格形式显示多个条形码对应的有关个人信息和报告情况，

若还未出报告，则显示“未接收”

若已出报告，则显示“接收完成”

如接收完成，点击条形码等相关个人信息，可直接跳转到详细报告页面，可在线查看报告和下载报告。

如后台人员还未还未上传报告，则显示提示信息“请等待20天......”

## 3月2号

对于微信公众号项目-数据库表-barcode 对于条形码字段的长度应该重新设定

## 3月10号

### 登录

使用springcurity来做登录校验和授权，故除了账号表，还需要设置角色表和权限表



如果为了用到remember-me功能，需要使用多一张表，但是可以使用spring security来自动生成！