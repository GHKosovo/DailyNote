## 什么是索引，有什么用

索引相当于一本书的目录，通过目录可以快速的找到对应的资源

在数据库方面，查询一张表的时候有两种检索方式：

- 第一种方式：全表扫描
- 第二种方式：根据索引检索（效率高）

**索引为什么可以提高检索效率呢？**

​	其实其根本原理就是缩小了扫描的范围；

索引虽然可以提高检索雄安率，但是不能随意的添加索引，因为索引也是数据库中的对象，也需要数据库不断地维护，是有维护成本的。比如：表中的数据经常被修改，这样就不适合添加索引，因为一旦修改，所以需要重新排序，进行维护。

添加索引是给某一个字段，或者说某些字段添加索引。

### 怎么创建索引对象，怎么删除索引对象

创建索引对象：

​	create index 索引名称 on 表名（字段名）

删除索引都西昂：

​	drop index 索引名称 on 表名；

### 什么时候考虑给字段添加添加索引

- 数据量庞大（根据客户的需求，根据线上的环境）
- 该字段很少的DML操作（因为字段进行修改操作，索引也需要维护）
- 该字段经常出现在where子句中（经常根据哪个字段查询）

### 注意：主键合具有unique约束的字段自动会添加索引

根据主键查询效率较高；尽量根据主键检索

### 查看sql语句的执行计划

```
mysql> explain select ename,sal from emp where sal = 5000;
```

| id   | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra       |
| ---- | ----------- | ----- | ---- | ------------- | ---- | ------- | ---- | ---- | ----------- |
| 1    | SIMPLE      | emp   | ALL  | NULL          | NULL | NULL    | NULL | 14   | Using where |

给薪资sal字段添加索引:

​	create index emp_sal_index on emp(sal);

| id   | select_type | table | type | possible_keys | key           | key_len | ref   | rows | Extra       |
| ---- | ----------- | ----- | ---- | ------------- | ------------- | ------- | ----- | ---- | ----------- |
| 1    | SIMPLE      | emp   | ref  | emp_sal_index | emp_sal_index | 9       | const | 1    | Using where |

> 索引底层采用的数据结构是：B+Tree

## 索引的原理

通过B Tree缩小扫描原理，底层索引进行了排序，分区，索引会携带数据在表中的“物理地址”，最终通过索引检索到数据之后，获取到关联的物理地址，通过物理地址定位表中的数据，效率是最高的

```
select ename from emp where name = 'SMITH';
通过索引转换为：
select ename from emp where 物理地址 = 0x3;
```

## 索引的分类？

单一索引：给单个字段添加索引

复合索引：给多个字段联合起来添加一个索引

主键索引：主键上回自动添加索引

唯一索引：有unique约束的字段回自动添加索引

## 索引什么时候失效

```
select ename from emp where ename like '%A%'
```

模糊查询的时候，第一个通配符使用的是%，这个时候索引是失效的